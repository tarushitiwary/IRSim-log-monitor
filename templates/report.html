<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>IRSim Threat Report</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light p-4">
    <div class="container">
        <h1 class="text-center mb-4">IRSim Incident Response Report</h1>
        <p><strong>Generated:</strong> {{ generation_time }}</p>

        <h3>Detected Threats</h3>
        {% if attempts %}
        <table class="table table-bordered">
            <thead>
                <tr>
                    <th>IP Address</th>
                    <th>Failed Attempts</th>
                    <th>Geo Location</th>
                </tr>
            </thead>
            <tbody>
                {% for ip, data in attempts.items() %}
                <tr>
                    <td>{{ ip }}</td>
                    <td>{{ data['count'] }}</td>
                    <td>{{ data['location'] }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
        {% else %}
        <p class="text-muted">No suspicious activity detected.</p>
        {% endif %}

        <h3>Attack Visualization</h3>
            <img src="static/chart.png" class="img-fluid border" alt="Bar chart showing the number of brute force login attempts by IP address with each bar labeled by IP and attempt count in a neutral report setting">

        <hr>
        <footer class="text-center">
<p class="text-muted">IRSim by Tarushi Tiwary | GitHub: <a href="https://github.com/tarushitiwary">github.com/tarushitiwary</a></p>        </footer>
    </div>
</body>
</html>
